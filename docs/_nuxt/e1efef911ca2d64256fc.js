(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{149:function(t,e,n){var i=n(166);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,n(32).default)("22bc637e",i,!0,{sourceMap:!1})},152:function(t,e,n){var i=n(176);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,n(32).default)("107030a0",i,!0,{sourceMap:!1})},165:function(t,e,n){"use strict";var i=n(149);n.n(i).a},166:function(t,e,n){(t.exports=n(31)(!1)).push([t.i,"\nsection[data-v-6a8fa49a]:not(:last-child){margin-bottom:1rem\n}\n.content-wrapper[data-v-6a8fa49a]{padding:1rem\n}\n.close-wrapper[data-v-6a8fa49a]{text-align:right\n}\n.close-button[data-v-6a8fa49a]{margin:0;display:inline-block;color:#f22\n}",""])},167:function(t,e,n){"use strict";n.r(e),n.d(e,"locate",function(){return a}),n.d(e,"_createMarker",function(){return o}),n.d(e,"_activateDescriptionUIElement",function(){return s}),n.d(e,"_centerMap",function(){return c}),n.d(e,"_setLocationMarker",function(){return l});n(47);var i=n(6),r=n.n(i);n(1),n(2),n(3);function a(){var t=this,e=this.map;this.locating=!0,e.locate({enableHighAccuracy:!0}).once("locationfound",function(e){t.location=[e.latlng.lat,e.latlng.lng],t.zoom=16,t.viewCenter=t.location,t.locating=!1}).once("locationerror",function(){var e=r()(regeneratorRuntime.mark(function e(n){var i,r,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,"http://api.petabyet.com/geoip/",e.next=4,fetch("http://api.petabyet.com/geoip/");case 4:return i=e.sent,e.next=7,i.json();case 7:r=e.sent,a=r.latitude,o=r.longitude,t.viewCenter=t.location=[a,o],e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),console.error("Cannot locate by IP address using "+hostname),console.error(e.t0);case 17:t.locating=!1;case 18:case"end":return e.stop()}},e,this,[[0,13]])}));return function(t){return e.apply(this,arguments)}}())}function o(t,e){var i=this;return new(n(150).Marker)(t.geo,e).on("click",function(e){i.viewCenter=t.geo,i.selectedMarker=t,i.$store.commit("ui/setActiveUIElement","description")}).addTo(this.map),t}function s(){this.$store.commit("ui/setActiveUIElement","description")}function c(t){var e=this;this.$nextTick(function(){e.map.invalidateSize(!0),e.map.setView(t,e.zoom)})}function l(){if(!this.locationMarker){var t=n(150),e=new t.Icon({iconUrl:"https://cdn0.iconfinder.com/data/icons/small-n-flat/24/678111-map-marker-512.png",iconSize:[50,50]});this.locationMarker=new t.Marker(this.location,{icon:e}).addTo(this.map)}this.locationMarker.setLatLng(this.location)}},168:function(t,e,n){"use strict";n.r(e),function(t){n.d(e,"default",function(){return a});n(47);var i=n(6),r=n.n(i);n(1),n(2),n(3);function a(){return o.apply(this,arguments)}function o(){return(o=r()(regeneratorRuntime.mark(function e(){var i,r,a,o,s=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=n(150),r=new i.map(this.$refs.map,{zoomControl:!1,attributionControl:!1}),this.map=r,this.locationMarker=null,r.setView(this.viewCenter,this.zoom),t(function(){s.locate()}),i.control.attribution({position:"bottomright",prefix:"Drink&Piss"}).addTo(r),"http://{s}.tile.stamen.com/terrain/{z}/{x}/{y}.jpg","https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",i.tileLayer("https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_nolabels/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>',subdomains:"abcd",maxZoom:19}).addTo(r),i.tileLayer("https://cartodb-basemaps-{s}.global.ssl.fastly.net/rastertiles/voyager_nolabels/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>',subdomains:"abcd",maxZoom:19}),this._markerIcon=new i.Icon({iconUrl:"/img/water-drop.png",iconSize:[50,50]}),r.on("click",function(t){var e=[t.latlng.lat,t.latlng.lng];s._createMarker({geo:e},{icon:s._markerIcon})}),e.prev=13,e.next=16,fetch("//alexeimyshkouski-1.herokuapp.com/waterpoint");case 16:return o=e.sent,e.next=19,o.json();case 19:a=e.sent,e.next=25;break;case 22:e.prev=22,e.t0=e.catch(13),a=[];case 25:this.$store.commit("markers/addFetchedMarkers",a);case 26:case"end":return e.stop()}},e,this,[[13,22]])}))).apply(this,arguments)}}.call(this,n(93).setImmediate)},175:function(t,e,n){"use strict";var i=n(152);n.n(i).a},176:function(t,e,n){(t.exports=n(31)(!1)).push([t.i,"\n.content-wrapper[data-v-6f31863e]{display:flex;flex-flow:column;position:absolute;max-width:100%;width:100vw;max-height:100%;height:100vh\n}\n.map-wrapper[data-v-6f31863e]{position:absolute;z-index:0;overflow:hidden\n}\n.map[data-v-6f31863e],.map-wrapper[data-v-6f31863e]{width:100%;height:100%\n}\n.map[data-v-6f31863e]{overflow:visible\n}\n.map-wrapper.with-description .map[data-v-6f31863e]{height:40%\n}\n.locate[data-v-6f31863e]{position:absolute;overflow:hidden;width:3rem;height:3rem;left:1.5rem;bottom:1.5rem;z-index:90;background-image:url(/img/geo.svg);background-size:1.75rem;background-position:50%;background-repeat:no-repeat;-webkit-filter:brightness(0) invert(1);filter:brightness(0) invert(1)\n}\n.description[data-v-6f31863e]{display:none;position:absolute;bottom:0;left:0;right:0;width:100%;height:60%;z-index:99;background-color:#111;color:#fff\n}\n.description.active[data-v-6f31863e]{display:block\n}\n.debug[data-v-6f31863e]{position:fixed;top:0;right:0;padding:.25rem;background-color:rgba(0,0,0,.5)\n}\n.debug p[data-v-6f31863e]{padding:0;color:#fff;font-size:.75rem\n}",""])},177:function(t,e,n){"use strict";n.r(e);n(47);var i,r=n(6),a=n.n(r),o=n(24),s=n.n(o),c=(n(1),n(2),n(3),n(29)),l={props:{marker:null},data:function(){return{description:null}},watch:{location:function(t,e){var n=!1;if(e){for(var i in t)if(t[i]!==e[i]){n=!0;break}}else n=!0;n&&this.fetchDescription()},showDescriptionUIElement:function(t){t?this.fetchDescription():this.description=null}},computed:s()({},Object(c.b)({showDescriptionUIElement:"ui/isDescriptionActive"})),mounted:function(){this.fetchDescription()},methods:{fetchDescription:(i=a()(regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.marker){t.next=8;break}return e=this.marker.geo,t.next=4,fetch("https://nominatim.osm.org/reverse?format=json&lat=".concat(e[0],"&lon=").concat(e[1]));case 4:return n=t.sent,t.next=7,n.json();case 7:this.description=t.sent;case 8:case"end":return t.stop()}},t,this)})),function(){return i.apply(this,arguments)}),hideDescription:function(){this.$store.commit("ui/setActiveUIElement",null)}}},p=(n(165),n(16)),u=Object(p.a)(l,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"_"},[n("div",{staticClass:"content-wrapper"},[n("div",{staticClass:"close-wrapper"},[n("p",{staticClass:"close-button",on:{click:t.hideDescription}},[t._v("Close")])]),t.description?n("article",[t.description.address?n("section",[n("p",[t._v("Address:")]),t.description.address.road?n("span",[t._v(t._s(t.description.address.road)+", ")]):t._e(),t.description.address.house_number?n("span",[t._v(t._s(t.description.address.house_number)+", ")]):t._e(),t.description.address.city?n("span",[t._v(t._s(t.description.address.city))]):t._e()]):t._e(),"lat"in t.description&&"lon"in t.description?n("section",[n("p",[t._v("Geo:")]),n("span",[t._v(t._s(t.description.lat)+",")]),n("span",[t._v(t._s(t.description.lon))])]):t._e(),t.marker&&t.marker.about?n("section",{staticClass:"about"},[n("p",[t._v("About:")]),n("span",[t._v(t._s(t.marker.about))])]):t._e()]):t._e()])])},[],!1,null,"6a8fa49a",null);u.options.__file="description.vue";e.default=u.exports},178:function(t,e,n){"use strict";n.r(e);var i=n(24),r=n.n(i),a=(n(33),n(1),n(2),n(3),n(156),n(29)),o={data:function(){return{viewCenter:[53,26],location:null,zoom:5,map:null,selectedMarker:null,locating:!1}},components:{DescriptionComponent:n(177).default},watch:{location:"_setLocationMarker",viewCenter:"_centerMap",activeUIElement:function(){var t=this;this.$nextTick(function(){t.map.invalidateSize(!0)})},markers:function(){var t=this;this.markers.forEach(function(e){t._createMarker(e,{icon:t._markerIcon})})}},computed:r()({},Object(a.b)({showDescriptionUIElement:"ui/isDescriptionActive",markers:"markers/markers"}),Object(a.c)({activeUIElement:function(t){return t.ui.activeUIElement}})),methods:r()({},n(167)),mounted:n(168).default},s=(n(169),n(175),n(16)),c=Object(s.a)(o,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"_"},[e("div",{staticClass:"content-wrapper"},[e("div",{staticClass:"map-wrapper",class:{"with-description":this.showDescriptionUIElement}},[e("div",{ref:"map",staticClass:"map"})]),e("div",{staticClass:"locate",class:{spinned:this.locating},on:{click:this.locate}}),e("DescriptionComponent",{staticClass:"description",class:{active:this.showDescriptionUIElement},attrs:{marker:this.selectedMarker}})],1)])},[],!1,null,"6f31863e",null);c.options.__file="index.vue";e.default=c.exports}}]);